<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Establish a Multi-User blaseRtemplates Installation • blaseRtemplates</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Establish a Multi-User blaseRtemplates Installation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blaseRtemplates</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9212</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/establish.html">Establish a blaseRtemplates Installation</a></li>
    <li><a class="dropdown-item" href="../articles/initialize.html">Initialize a blaseRtemplates Project</a></li>
    <li><a class="dropdown-item" href="../articles/install.html">Installing Packages</a></li>
    <li><a class="dropdown-item" href="../articles/multiuser.html">Establish a Multi-User blaseRtemplates Installation</a></li>
    <li><a class="dropdown-item" href="../articles/project_data.html">Managing Project Data</a></li>
    <li><a class="dropdown-item" href="../articles/using_git.html">Using Git</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/blaserlab/blaseRtemplates/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Establish a Multi-User blaseRtemplates Installation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/blaserlab/blaseRtemplates/blob/HEAD/vignettes/multiuser.Rmd" class="external-link"><code>vignettes/multiuser.Rmd</code></a></small>
      <div class="d-none name"><code>multiuser.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="notes-for-the-system-administrator-of-a-multi-user-blasertemplates-environemnt">Notes for the System Administrator of a Multi-User blaseRtemplates
Environemnt<a class="anchor" aria-label="anchor" href="#notes-for-the-system-administrator-of-a-multi-user-blasertemplates-environemnt"></a>
</h2>
<p>The blaseRtemplates environment works well for a multiuser system
running Rstudio server. In fact it was designed for this purpose. Here
are the steps you need to perform to set this up:</p>
<ol style="list-style-type: decimal">
<li>Run blaseRtemplates::establish_new_bt() but make sure the cache_path
parameter points to a directory that is/will be available to all of your
users. The project_path parameter can point to your own workspace.</li>
<li>Go to $R_HOME/etc. Replace Rprofile.site with the contents of the
.Rprofile generated in the cache directory.</li>
<li>In the same directory, add the lines from the .Renviron file
generated by establish_new_bt() to the Renviron.site file. You may need
to have other things in there so don’t overwrite the whole file.</li>
<li>Create an empty directory “user_name” within the user_project
library directory of the cache. This should get populated when the user
starts making projects.</li>
<li>Since the other users will not be running establish_new_bt(), they
won’t have a baseproject. You need this to provide functionality for the
users if/when they get out of a project. Bad things happen when they are
not working in a valid project. So you need to move your baseproject to
the cache directory and edit the new Rprofile.site file to point all of
the users to that. You can do the latter by replacing the tryCatch
statement in the beginning of the .First function with this (note the
path you need to edit in the third-to-last line):</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># always be working within a project</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/proj_activate.html" class="external-link">proj_activate</a></span><span class="op">(</span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/proj_utils.html" class="external-link">proj_get</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span>,</span>
<span>error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">cond</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/libPaths.html" class="external-link">.libPaths</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"BLASERTEMPLATES_CACHE_ROOT"</span><span class="op">)</span>,</span>
<span>    <span class="st">"user_project"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"USER"</span><span class="op">)</span>,</span>
<span>    <span class="st">"baseproject"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/libPaths.html" class="external-link">.libPaths</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/proj_activate.html" class="external-link">proj_activate</a></span><span class="op">(</span><span class="st">"/path/to/baseproject"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Edit your sudo crontab file by running <code>sudo crontab -e</code>
and include something like this:</li>
</ol>
<!-- --><pre><code>* * * * * chmod -R 777 /path/to/cache_R_4_2/library</code></pre>
<p>This will set 777 permissions on the package library. This way all of
your users can read and write to the library. If you want more security
you can tweak the permissions and group settings, but this can be tricky
to maintain because of the limitations in the file writing and linking
programs used within R. Usually I find the 777 permissions to work well.
In normal operations, everything is versioned so your users won’t
overwrite anything useful. The only problem is if someone goes in and
clobbers the cache from the command line or through the Rstudio file
manager either maliciously or by accident. To protect against this you
should back up your cache to another drive.</p>
<ol start="7" style="list-style-type: decimal">
<li>If everything works, when your users log in, they should start out
in the baseproject. From there they can make or clone their own projects
using the usual functions.</li>
</ol>
</div>
<div class="section level2">
<h2 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h2>
<p>These operations are not routinely tested with multiple users, so may
require some tweaking. However this is basically what we use in
production. Please post any issues to the <a href="https://github.com/blaserlab/blaseRtemplates/issues" class="external-link">blaseRtemplates
issues page.</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brad Blaser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
